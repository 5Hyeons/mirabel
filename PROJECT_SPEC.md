# 내시경 환자 AI 상담 플랫폼 - 프로젝트 명세서

## 📋 프로젝트 개요

### 프로젝트 명
**내시경 검사 사전교육 및 AI 상담 플랫폼 (Mirabel)**

### 버전
**v1.0.0** (Initial Release)

### 작성일
2025년 10월 13일

---

## 🎯 프로젝트 목표

### 비전
내시경 검사를 앞둔 환자들에게 **개인화된 사전교육**과 **실시간 AI 상담**을 제공하여, 검사에 대한 불안감을 줄이고 의료진의 업무 효율을 높이는 디지털 헬스케어 플랫폼을 구축합니다.

### 핵심 목표
1. **환자 불안감 해소**: 검사 전 충분한 정보 제공으로 심리적 안정감 향상
2. **의료진 업무 효율화**: 반복적인 설명 업무 자동화로 진료 집중도 향상
3. **법적 동의 절차 디지털화**: 종이 기반 동의서를 디지털로 전환하여 관리 효율성 증대
4. **24/7 환자 지원**: AI 상담을 통한 시간 제약 없는 환자 문의 대응

---

## 👥 타겟 사용자

### 주 사용자 (Primary User)
- **내시경 검사 예약 환자**
  - 연령: 30세~70세
  - 디지털 리터러시: 중급 (스마트폰 기본 조작 가능)
  - 주요 니즈: 검사 불안감 해소, 검사 절차 이해, 즉각적인 질문 응답

### 부 사용자 (Secondary User)
- **병원 관리자 및 의료진**
  - 역할: 환자 링크 생성 및 발송, 동의서 확인, 상담 기록 관리
  - 주요 니즈: 환자 관리 효율화, 법적 문서 관리

---

## 🔑 주요 기능 요구사항

### 1. 환자 인증 및 예약 확인
- **개인화된 URL 접근**: 병원이 생성한 고유 URL을 통한 환자 식별
- **예약 정보 표시**: 환자명, 생년월일, 예약 병원, 검사 일시
- **보안**: URL 토큰 기반 인증 (타임아웃 설정 가능)

### 2. 검사 안내
- **담당 의사 소개**: 실제 의료진 사진 및 소속 정보
- **검사 정보 제공**: 내시경 검사 절차, 주의사항, 가능한 부작용 등
- **다국어 지원**: 한국어, 영어 (향후 확장)

### 3. 디지털 동의서 작성
- **체크박스 동의**: 추가 검사 및 비용 발생 동의
- **전자 서명**: 터치/마우스 기반 손글씨 서명 입력
- **음성 녹음 동의**: 사전 동의 문구 낭독 및 녹음 저장
- **법적 효력**: 전자서명법 준수 (타임스탬프, 서명자 정보 기록)

### 4. AI 아바타 상담
- **실시간 음성 대화**: LiveKit 기반 저지연 음성 통신
- **3D 아바타 인터페이스**: Unity WebGL 기반 의사 아바타 렌더링
- **자연어 이해**: LLM 기반 환자 질문 분석 및 응답
- **답변 중단 기능**: 사용자가 원할 때 Agent 응답 중단 (Interrupt)
- **상담 기록 저장**: 음성 및 텍스트 로그 저장

### 5. 모바일 최적화
- **반응형 디자인**: 모바일 우선 (360px~812px)
- **터치 인터랙션**: 버튼, 스와이프, 제스처 최적화
- **성능 최적화**: WebGL 경량화, 이미지 압축, 레이지 로딩

---

## 📱 전체 User Flow

```
┌─────────────────────────────────────────────────────────────────┐
│  1. 병원: 환자 정보 입력 → 개인화 URL 생성 → SMS/Email 발송          │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│  2. 환자: 링크 클릭 → 진입화면 (예약 정보 확인)                      │
│     - 환자명, 생년월일, 예약 병원, 검사 일시 표시                    │
│     - "검사 설명 보기" 버튼 클릭                                   │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│  3. 검사 안내                                                    │
│     3-1. 담당 의사 소개 (사진, 소속, 전문 분야)                     │
│     3-2. 내시경 검사 설명 (절차, 주의사항, 페이지네이션 1/4)          │
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│  4. 동의서 작성 프로세스                                           │
│     4-1. 체크박스 동의 (추가 검사 및 비용 발생)                      │
│     4-2. 전자 서명 (손글씨 입력, 지우기 기능)                        │
│     4-3. 음성 녹음 동의 (낭독 문구, 녹음 시작/중지/재생)              │
│     4-4. 동의서 완료 확인 화면                                     │
└─────────────────────────────────────────────────────────────────┘
                              ↓
                    ┌──────────────────┐
                    │  "추가 문의하기"   │
                    │  or "완료"        │
                    └──────────────────┘
                              ↓
                    ┌──────────────────┐
                    │  5. AI 상담       │
                    │  (선택 사항)      │
                    └──────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│  5. AI 아바타 상담 (WebGL + LiveKit)                              │
│     - 3D 의사 아바타와 실시간 음성 대화                             │
│     - 내시경 관련 질문 응답 (검사 절차, 준비사항, 부작용 등)           │
│     - "답변 멈추기" (Interrupt), "끝내기" (종료)                   │ 
└─────────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────────┐
│  6. 완료 → 병원: 동의서 및 상담 기록 확인 가능                       │
└─────────────────────────────────────────────────────────────────┘
```

---

## 🎨 디자인 원칙

### UI/UX 가이드라인

#### 1. 색상 시스템
- **Primary Color**: `#6490FF` (Blue) - 신뢰감, 의료 전문성
- **Background**: `#FFFFFF` (White), `#F0F3FF` (Light Blue)
- **Text**: `#111111` (Dark Gray), `#FFFFFF` (White on Blue)
- **Accent**: `#FF6B6B` (Red) - 녹음 중 상태

#### 2. 타이포그래피
- **폰트 패밀리**: Noto Sans KR (한글 가독성 최적화)
- **크기**:
  - H1: 24px (Bold) - 제목
  - Body: 16px (Regular/Medium) - 본문
  - Caption: 14px (Regular) - 설명

#### 3. 레이아웃
- **Container Width**: 360px (모바일 기준)
- **Padding**: 20px (좌우), 16px (카드 내부)
- **Border Radius**: 8px (버튼, 카드), 10px (큰 카드)
- **Button Height**: 56px (주요 액션), 48px (보조 액션)

#### 4. 인터랙션
- **피드백**: 버튼 클릭 시 scale 애니메이션 (0.95배)
- **트랜지션**: 화면 전환 시 fade-in (300ms)
- **로딩**: 스켈레톤 UI 또는 스피너

---

## 🚀 배포 및 운영

### 배포 환경
- **Production**: AWS/Azure/GCP 클라우드
- **Staging**: 병원 테스트용 환경
- **Development**: 로컬 개발 환경

### 모니터링
- **성능 모니터링**: New Relic, DataDog
- **에러 트래킹**: Sentry
- **사용자 분석**: Google Analytics, Mixpanel

### 유지보수
- **자동 백업**: 일일 데이터베이스 백업
- **로그 보관**: 6개월 (법적 요구사항 준수)
- **버전 관리**: Git (GitHub/GitLab)

---

## 📚 관련 문서

- `ARCHITECTURE.md` - 기술 스택 및 시스템 아키텍처
- `SCREENS_SPEC.md` - 화면별 상세 명세
- `API_SPEC.md` - API 엔드포인트 및 데이터 구조
- `LIVEKIT_INTEGRATION.md` - LiveKit + WebGL 통합 가이드
- `figma_node_ids.md` - Figma 디자인 노드 참조

---
